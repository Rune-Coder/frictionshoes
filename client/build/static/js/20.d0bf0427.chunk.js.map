{"version":3,"sources":["pages/paymentSuccess/paymentSuccess.module.css","pages/paymentSuccess/paymentSuccess.js"],"names":["module","exports","PaymentSuccess","props","useEffect","document","title","window","scrollTo","navigate","useNavigate","login","useSelector","state","loggedin","address","localStorage","getItem","JSON","parse","pin","replace","userSub","userData","useState","orders","setOrders","dispatch","useDispatch","email","a","cart","bill","fetch","method","headers","body","stringify","res","json","data","ok","getOrders","className","classes","layout","badge","onClick","event","amount","products","currOrder","slice","push","order_id","status","payment","date","postOrders","addressActions","remAddress","continue","subHead"],"mappings":"sGACAA,EAAOC,QAAU,CAAC,MAAQ,8BAA8B,SAAW,iCAAiC,OAAS,+BAA+B,QAAU,kC,2IC6GvIC,UAtGf,SAAwBC,GAEpBC,qBAAU,WACNC,SAASC,MAAQ,qDACjBC,OAAOC,SAAS,EAAG,MAIvB,IAAIC,EAAWC,cACTC,EAAQC,aAAY,SAACC,GAAD,OAAWA,EAAMF,MAAMG,YAEjDV,qBAAU,WAEN,IAAMW,EAAUC,aAAaC,QAAQ,WAAaC,KAAKC,MAAMH,aAAaC,QAAQ,YAAc,GAE5FN,GAAUI,EAAQK,KAClBX,EAAS,IAAK,CAAEY,SAAS,MAE9B,CAACZ,EAAUE,IAGd,IAAMW,EAAUV,aAAY,SAACC,GAAD,OAAWA,EAAMF,MAAMY,YAEnD,EAA4BC,mBAAS,IAArC,mBAAOC,EAAP,KAAeC,EAAf,KACMC,EAAWC,cAxBS,4CAkD1B,WAA0BC,EAAOJ,GAAjC,mBAAAK,EAAA,6DAEUC,EAAO,GACPC,EAAO,GAHjB,SAIsBC,MAAM,2BAA4B,CAChDC,OAAQ,OACRC,QAAQ,CACJ,eAAgB,oBAEpBC,KAAMlB,KAAKmB,UAAU,CAAER,QAAOE,OAAMC,OAAMP,aATlD,cAIUa,EAJV,gBAYUA,EAAIC,OAZd,2CAlD0B,wBA4F1B,OAlEAnC,qBAAU,WAAK,4CAGX,WAAyByB,GAAzB,iBAAAC,EAAA,sEAEsBG,MAAM,wBAAyB,CAC7CC,OAAQ,OACRC,QAAQ,CACJ,eAAgB,oBAEpBC,KAAMlB,KAAKmB,UAAU,CAAER,YAP/B,cAEUS,EAFV,gBAUuBA,EAAIC,OAV3B,OAUUC,EAVV,OAYOF,EAAIG,IAAMD,EAAKf,QACdC,EAAUc,EAAKf,QAbvB,4CAHW,2DAmBXiB,CAAUpB,EAAQO,SAEnB,CAACP,EAAQO,QA8CR,sBAAKc,UAAWC,IAAQC,OAAxB,UACI,8BAAK,sBAAMF,UAAWC,IAAQE,MAAzB,SAAgC,cAAC,IAAD,QACrC,oDACA,wBAAQC,QA9BhB,SAAiBC,GAEb,IAAMhB,EAAOhB,aAAaC,QAAQ,aAAeC,KAAKC,MAAMH,aAAaC,QAAQ,cAAgB,CAAC,CAACgC,OAAQ,IACrGC,EAAWlC,aAAaC,QAAQ,YAAcC,KAAKC,MAAMH,aAAaC,QAAQ,aAAe,GAC7FF,EAAUC,aAAaC,QAAQ,WAAaC,KAAKC,MAAMH,aAAaC,QAAQ,YAAc,GAE5FkC,EAAY1B,EAAO2B,QACnBD,EAAUE,KAAK,CACXC,SAAU,GACVC,OAAQ,aACRvB,KAAMA,EACNkB,SAAUA,EACVM,QAAS,SACTzC,QAASA,EACT0C,KAAM,KAhFQ,sCAmFtBC,CAAWpC,EAAQO,MAAOsB,GAE1BxB,EAASgC,IAAeC,cAExBnD,EAAS,UAAW,CAAEY,SAAS,KASCsB,UAAWC,IAAQiB,SAA/C,sBACA,mBAAGlB,UAAWC,IAAQkB,QAAtB","file":"static/js/20.d0bf0427.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"badge\":\"paymentSuccess_badge__2pVbq\",\"continue\":\"paymentSuccess_continue__Ezfum\",\"layout\":\"paymentSuccess_layout__3Q4qf\",\"subHead\":\"paymentSuccess_subHead__1R3zm\"};","import React, { useState, useEffect } from 'react';\n\nimport { useNavigate } from 'react-router-dom';\nimport BadgeCheckIcon from '../../icons/badgeCheckIcon';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { addressActions } from '../../store/addressStore';\nimport classes from './paymentSuccess.module.css';\n\nfunction PaymentSuccess(props){\n\n    useEffect(() => {\n        document.title = 'Online Shopping site for shoes in India | Friction';\n        window.scrollTo(0, 0);\n    });\n\n\n    let navigate = useNavigate();\n    const login = useSelector((state) => state.login.loggedin);\n\n    useEffect(() =>{\n\n        const address = localStorage.getItem(\"address\") ? JSON.parse(localStorage.getItem(\"address\")) : {};\n\n        if(!login || !address.pin)\n            navigate(`/`, { replace: true });\n\n    }, [navigate, login]);\n\n    \n    const userSub = useSelector((state) => state.login.userData);\n\n    const [orders, setOrders] = useState([]);\n    const dispatch = useDispatch();\n\n    useEffect(() =>{\n\n         //get orders data mongodb\n        async function getOrders(email){\n\n            const res = await fetch(\"/api/user/history-get\", {\n                method: \"POST\",\n                headers:{\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({ email })\n            });\n        \n            const data = await res.json();\n                \n            if(res.ok && data.orders)\n                setOrders(data.orders);\n        }\n        \n        getOrders(userSub.email);\n        \n    }, [userSub.email]);\n\n    //post orders\n    async function postOrders(email, orders){\n\n        const cart = [];\n        const bill = [];\n        const res = await fetch(\"/api/user/history-create\", {\n            method: \"POST\",\n            headers:{\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({ email, cart, bill, orders })\n        });\n    \n        await res.json();\n    }\n\n\n    function toOrder(event){\n\n        const bill = localStorage.getItem(\"billStore\") ? JSON.parse(localStorage.getItem(\"billStore\")) : [{amount: 0}];\n        const products = localStorage.getItem(\"products\") ? JSON.parse(localStorage.getItem(\"products\")) : [];\n        const address = localStorage.getItem(\"address\") ? JSON.parse(localStorage.getItem(\"address\")) : {};\n\n        var currOrder = orders.slice();\n            currOrder.push({\n                order_id: \"\",\n                status: \"processing\",\n                bill: bill,\n                products: products,\n                payment: \"Online\",\n                address: address,\n                date: \"\"\n        });\n\n        postOrders(userSub.email, currOrder);\n\n        dispatch(addressActions.remAddress());\n\n        navigate(`/orders`, { replace: true });\n\n    }\n\n\n    return(\n        <div className={classes.layout}>\n            <div><span className={classes.badge}><BadgeCheckIcon /></span></div>\n            <p>Payment Successfull</p>\n            <button onClick = {toOrder} className={classes.continue}>CONTINUE</button>\n            <p className={classes.subHead}>Please do not go back or refresh page</p>\n        </div>\n    );\n}\n\nexport default PaymentSuccess;"],"sourceRoot":""}